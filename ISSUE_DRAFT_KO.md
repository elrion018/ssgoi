# [Feature Request]: 애니메이션 타입별 최적화된 DOM 복제 전략

## 개요

현재 SSGOI는 OUT 애니메이션 시 `element.cloneNode(true)`를 사용하여 전체 DOM 트리를 깊은 복사하고 있습니다. 이는 모든 애니메이션 타입에 대해 안정적으로 동작하지만, 단순한 fade out 같은 경우에는 불필요한 오버헤드를 발생시킬 수 있습니다.

## 현재 구현 분석

```typescript
// packages/core/src/lib/create-transition-callback.ts:147
const cloned = element.cloneNode(true) as HTMLElement; // 모든 자식 요소 포함 복사
```

### 관찰된 동작

현재 방식은 **안정성과 범용성**을 우선시한 구현입니다:
- ✅ 모든 애니메이션 타입(fade, scale, slide, hero 등)에서 완벽하게 동작
- ✅ 시각적으로 원본과 동일한 결과 보장
- ✅ 구현이 단순하고 예측 가능

하지만 다음과 같은 개선 여지가 있습니다:
- ⚠️ Fade out처럼 단순한 애니메이션에도 전체 DOM 트리 복사
- ⚠️ 복잡한 DOM 구조(수백~수천 개의 자식 요소)에서 성능 영향 가능
- ⚠️ 실제로는 보이지 않을 내부 콘텐츠까지 모두 복사

## 제안하는 개선 방향

애니메이션 타입에 따라 필요한 요소만 선택적으로 복사하는 최적화 전략을 도입하면 좋을 것 같습니다.

### 핵심 아이디어

**Fade Out의 경우:**
- 실제 필요한 것: 요소의 크기, 위치, 배경 스타일
- 불필요한 것: 내부 텍스트, 자식 요소들 (어차피 투명해져서 안 보임)

**Scale/Slide의 경우:**
- 필요한 것: 전체 시각적 요소 (현재 방식 유지)

**Hero Transition의 경우:**
- 필요한 것: `data-hero-key`를 가진 특정 요소만

### 예상되는 이점

1. **메모리 효율성**: 특히 복잡한 컴포넌트(테이블, 리스트, 폼 등)에서 불필요한 DOM 복제 감소

2. **성능 향상**: DOM 트리가 클수록 복제 시간이 선형적으로 증가하는 현재 방식 대비, 필요한 것만 복사하여 일정한 성능 유지

3. **모바일 최적화**: 제한된 리소스 환경에서 더 부드러운 애니메이션 제공

## 구현 제안

복잡한 구현보다는 점진적 개선을 제안합니다:

1. **1단계**: 애니메이션 타입을 감지하여 shallow/deep clone 선택
2. **2단계**: 개발자가 직접 복제 전략을 지정할 수 있는 옵션 제공
3. **3단계**: 실제 사용 패턴을 분석하여 자동 최적화

## 고려사항

- **하위 호환성**: 기본값은 현재 동작 유지 (deep clone)
- **안정성**: 시각적 문제가 없도록 충분한 테스트 필요
- **점진적 도입**: 옵트인 방식으로 시작하여 안정화 후 기본값 변경 고려

## 관련 컨텍스트

이 최적화는 특히 다음과 같은 상황에서 의미가 있을 것으로 보입니다:
- 대규모 테이블이나 리스트를 포함한 페이지 전환
- 복잡한 폼 요소들이 있는 관리자 페이지
- 모바일 웹 애플리케이션
- 빈번한 페이지 전환이 발생하는 SPA

## 추가 논의 사항

이 기능이 실제로 유용할지, 그리고 구현 복잡도 대비 이득이 충분할지에 대한 커뮤니티의 의견을 듣고 싶습니다. 특히 실제 프로덕션 환경에서 DOM 복제로 인한 성능 이슈를 경험하신 분들의 피드백이 있다면 도움이 될 것 같습니다.